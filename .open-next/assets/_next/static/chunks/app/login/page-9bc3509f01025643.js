(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},508:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},532:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...o,width:a,height:a,stroke:r,strokeWidth:i?24*Number(l)/Number(a):l,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{className:i,...c}=r;return(0,s.createElement)(l,{ref:o,iconNode:t,className:n("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=a(e),r}},3368:(e,t,r)=>{"use strict";r.d(t,{S:()=>s});class s{storeSession(){try{let e=this.getCurrentSessionId();return localStorage.setItem("zenow_session",e),!0}catch(e){return!1}}clearToken(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem("zenow_session")}clearSession(){localStorage.removeItem("zenow_session")}validateSession(){try{let e=localStorage.getItem("zenow_session");if(!e)return!1;let t=this.getCurrentSessionId();return e===t}catch(e){return!1}}hasToken(){return null!==localStorage.getItem(this.STORAGE_KEY)}getTokenInfo(){return{exists:this.hasToken(),session:localStorage.getItem("zenow_session"),fingerprint:this.getCurrentSessionId()}}getCurrentSessionId(){let e=document.createElement("canvas"),t=e.getContext("2d");return t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Browser fingerprint",2,2)),btoa([navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL()].join("|")).slice(0,32)}constructor(){this.STORAGE_KEY="zenow_secure_auth"}}},5404:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5155),a=r(2115),n=r(63),o=r(508),l=r(9708),i=r(532),c=r(7828),d=r(2619),u=r.n(d);try{r(3368).S}catch(e){}function m(){let[e,t]=(0,a.useState)(!1),[r,d]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[f,x]=(0,a.useState)(!1),[y,b]=(0,a.useState)(""),[w,v]=(0,a.useState)(!1),j=(0,n.useRouter)();(0,a.useEffect)(()=>{v(!0),b((()=>{let e=document.createElement("canvas"),t=e.getContext("2d");return t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Browser fingerprint",2,2)),btoa([navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL()].join("|")).slice(0,32)})())},[]);let N=async e=>{if(e.preventDefault(),!r||!m)return void p("Please enter both username and password.");x(!0),p("");try{let e=new FormData;e.append("username",r),e.append("password",m),e.append("fingerprint",y||"fallback");let t=await fetch("/api/auth/secure-login",{method:"POST",body:e});if(!t.ok){let e="Login failed. Please try again.";try{e=(await t.json()).error||"Login failed"}catch(r){e="Login failed (".concat(t.status,")")}p(e);return}let s=await t.json();s.success?j.replace("/dashboard"):p(s.error||"Login failed")}catch(e){p("Network error. Please check your connection and try again.")}finally{x(!1)}};return w?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"}),(0,s.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,s.jsx)(u(),{href:"/forgot-password",className:"font-medium text-blue-600 hover:text-blue-500",children:"reset your password"})]})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:N,children:[(0,s.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(o.A,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 pl-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Username",value:r,onChange:e=>d(e.target.value),disabled:f})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,s.jsx)(l.A,{className:"h-5 w-5 text-gray-400"})}),(0,s.jsx)("input",{id:"password",name:"password",type:e?"text":"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 pl-10 pr-10 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password",value:m,onChange:e=>h(e.target.value),disabled:f}),(0,s.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>t(!e),disabled:f,children:e?(0,s.jsx)(i.A,{className:"h-5 w-5 text-gray-400"}):(0,s.jsx)(c.A,{className:"h-5 w-5 text-gray-400"})})]})]}),g&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsx)("div",{className:"text-sm text-red-700",children:g})}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:f,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Signing in..."]}):"Sign in"})})]})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})})}},6928:(e,t,r)=>{Promise.resolve().then(r.bind(r,5404))},7828:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9708:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=6928)),_N_E=e.O()}]);