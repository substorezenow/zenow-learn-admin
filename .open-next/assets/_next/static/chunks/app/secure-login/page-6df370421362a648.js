(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[362],{63:(e,t,r)=>{"use strict";var s=r(7260);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},508:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},532:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},1847:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var s=r(2115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...h}=e;return(0,s.createElement)("svg",{ref:t,...o,width:a,height:a,stroke:r,strokeWidth:l?24*Number(i)/Number(a):i,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{className:l,...c}=r;return(0,s.createElement)(i,{ref:o,iconNode:t,className:n("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return r.displayName=a(e),r}},2414:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(5155),a=r(2115),n=r(63),o=r(7910),i=r(508),l=r(9708),c=r(532),d=r(7828),u=r(2619),h=r.n(u),m=r(3368);function g(){let[e,t]=(0,a.useState)(!1),[r,u]=(0,a.useState)(""),[g,x]=(0,a.useState)(""),[f,p]=(0,a.useState)(!1),[w,y]=(0,a.useState)(""),[b,v]=(0,a.useState)(""),j=(0,n.useRouter)(),N=(0,a.useMemo)(()=>new m.S,[]);(0,a.useEffect)(()=>{v(N.getTokenInfo().fingerprint||"fallback")},[N]);let k=async e=>{if(e.preventDefault(),!r||!g)return void y("Please enter both username and password.");p(!0),y("");try{let e=new FormData;e.append("username",r),e.append("password",g);let t=await fetch("/api/auth/secure-login",{method:"POST",body:e});if(!t.ok){let e=await t.json();throw Error(e.error||"Login failed")}await t.json(),N.storeSession(),j.push("/dashboard")}catch(e){console.error("Login error:",e),y(e instanceof Error?e.message:"Login failed")}finally{p(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-100 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"mx-auto h-12 w-12 bg-blue-600 rounded-full flex items-center justify-center",children:(0,s.jsx)(o.A,{className:"h-6 w-6 text-white"})}),(0,s.jsx)("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Secure Login"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Browser fingerprint encryption enabled"})]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(o.A,{className:"h-4 w-4 text-blue-600"}),(0,s.jsx)("span",{className:"text-sm font-medium text-blue-800",children:"Browser Fingerprint:"})]}),(0,s.jsx)("code",{className:"text-xs text-blue-700 bg-blue-100 px-2 py-1 rounded",children:b}),(0,s.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"Your token will be encrypted using this unique browser signature"})]}),(0,s.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:k,children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(i.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Username",className:"border border-gray-300 rounded px-10 py-2 w-full focus:outline-none focus:ring-2 focus:ring-indigo-400",value:r,onChange:e=>u(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-indigo-400"}),(0,s.jsx)("input",{type:e?"text":"password",placeholder:"Password",className:"border border-gray-300 rounded px-10 py-2 w-full focus:outline-none focus:ring-2 focus:ring-indigo-400",value:g,onChange:e=>x(e.target.value),required:!0}),(0,s.jsx)("button",{type:"button",className:"absolute right-3 top-1/2 -translate-y-1/2",onClick:()=>t(!e),children:e?(0,s.jsx)(c.A,{className:"w-5 h-5 text-gray-400"}):(0,s.jsx)(d.A,{className:"w-5 h-5 text-gray-400"})})]})]}),w&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:w}),(0,s.jsx)("button",{type:"submit",disabled:f,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Encrypting & Logging in..."]}):"Secure Login"}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(h(),{href:"/login",className:"text-sm text-indigo-600 hover:text-indigo-500",children:"Use standard login instead"})})]})]})})}},2590:(e,t,r)=>{Promise.resolve().then(r.bind(r,2414))},3368:(e,t,r)=>{"use strict";r.d(t,{S:()=>s});class s{storeSession(){try{let e=this.getCurrentSessionId();return localStorage.setItem("zenow_session",e),!0}catch(e){return!1}}clearToken(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem("zenow_session")}clearSession(){localStorage.removeItem("zenow_session")}validateSession(){try{let e=localStorage.getItem("zenow_session");if(!e)return!1;let t=this.getCurrentSessionId();return e===t}catch(e){return!1}}hasToken(){return null!==localStorage.getItem(this.STORAGE_KEY)}getTokenInfo(){return{exists:this.hasToken(),session:localStorage.getItem("zenow_session"),fingerprint:this.getCurrentSessionId()}}getCurrentSessionId(){let e=document.createElement("canvas"),t=e.getContext("2d");return t&&(t.textBaseline="top",t.font="14px Arial",t.fillText("Browser fingerprint",2,2)),btoa([navigator.userAgent,navigator.language,screen.width+"x"+screen.height,new Date().getTimezoneOffset(),e.toDataURL()].join("|")).slice(0,32)}constructor(){this.STORAGE_KEY="zenow_secure_auth"}}},7828:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7910:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},9708:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=2590)),_N_E=e.O()}]);